!function(){const n={apiUrl:window.CHATBOT_API_URL||"http://localhost:3000/api",token:null,position:"bottom-right",primaryColor:"#4F46E5",secondaryColor:"#7C3AED"},t=document.currentScript||document.querySelector("script[data-client-token]");t&&(n.token=t.getAttribute("data-client-token"),n.position=t.getAttribute("data-position")||n.position);const e=`\n    .ian-chatbot-widget {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      position: fixed;\n      z-index: 9999;\n    }\n\n    .ian-chatbot-button {\n      width: 60px;\n      height: 60px;\n      border-radius: 50%;\n      background: linear-gradient(135deg, ${n.primaryColor} 0%, ${n.secondaryColor} 100%);\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n    }\n\n    .ian-chatbot-button:hover {\n      transform: scale(1.1);\n      box-shadow: 0 6px 30px rgba(0, 0, 0, 0.3);\n    }\n\n    .ian-chatbot-button svg {\n      width: 30px;\n      height: 30px;\n      fill: white;\n    }\n\n    .ian-chatbot-window {\n      width: 380px;\n      height: 600px;\n      background: white;\n      border-radius: 16px;\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n      display: none;\n      flex-direction: column;\n      overflow: hidden;\n    }\n\n    .ian-chatbot-header {\n      background: linear-gradient(135deg, ${n.primaryColor} 0%, ${n.secondaryColor} 100%);\n      color: white;\n      padding: 20px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .ian-chatbot-header h3 {\n      margin: 0;\n      font-size: 18px;\n      font-weight: 600;\n    }\n\n    .ian-chatbot-close {\n      background: none;\n      border: none;\n      color: white;\n      cursor: pointer;\n      padding: 4px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border-radius: 4px;\n      transition: background 0.2s ease;\n    }\n\n    .ian-chatbot-close:hover {\n      background: rgba(255, 255, 255, 0.2);\n    }\n\n    .ian-chatbot-messages {\n      flex: 1;\n      overflow-y: auto;\n      padding: 20px;\n      background: #f9fafb;\n    }\n\n    .ian-chatbot-message {\n      margin-bottom: 16px;\n      display: flex;\n      align-items: flex-start;\n      gap: 8px;\n    }\n\n    .ian-chatbot-message.user {\n      flex-direction: row-reverse;\n    }\n\n    .ian-chatbot-message-content {\n      max-width: 70%;\n      padding: 12px 16px;\n      border-radius: 12px;\n      font-size: 14px;\n      line-height: 1.5;\n    }\n\n    .ian-chatbot-message.assistant .ian-chatbot-message-content {\n      background: white;\n      color: #111827;\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n    }\n\n    .ian-chatbot-message.user .ian-chatbot-message-content {\n      background: ${n.primaryColor};\n      color: white;\n    }\n\n    .ian-chatbot-input-container {\n      padding: 20px;\n      background: white;\n      border-top: 1px solid #e5e7eb;\n    }\n\n    .ian-chatbot-input-wrapper {\n      display: flex;\n      gap: 10px;\n    }\n\n    .ian-chatbot-input {\n      flex: 1;\n      padding: 12px 16px;\n      border: 2px solid #e5e7eb;\n      border-radius: 8px;\n      font-size: 14px;\n      outline: none;\n      transition: border-color 0.2s ease;\n    }\n\n    .ian-chatbot-input:focus {\n      border-color: ${n.primaryColor};\n    }\n\n    .ian-chatbot-send {\n      padding: 12px 20px;\n      background: ${n.primaryColor};\n      color: white;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n      font-weight: 600;\n      transition: background 0.2s ease;\n    }\n\n    .ian-chatbot-send:hover {\n      background: ${n.secondaryColor};\n    }\n\n    .ian-chatbot-send:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    .ian-chatbot-typing {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n      padding: 12px 16px;\n    }\n\n    .ian-chatbot-typing span {\n      width: 8px;\n      height: 8px;\n      background: #6b7280;\n      border-radius: 50%;\n      animation: typing 1.4s infinite;\n    }\n\n    .ian-chatbot-typing span:nth-child(2) {\n      animation-delay: 0.2s;\n    }\n\n    .ian-chatbot-typing span:nth-child(3) {\n      animation-delay: 0.4s;\n    }\n\n    @keyframes typing {\n      0%, 60%, 100% {\n        opacity: 0.3;\n        transform: scale(0.8);\n      }\n      30% {\n        opacity: 1;\n        transform: scale(1);\n      }\n    }\n\n    .ian-chatbot-widget.bottom-right {\n      bottom: 20px;\n      right: 20px;\n    }\n\n    .ian-chatbot-widget.bottom-left {\n      bottom: 20px;\n      left: 20px;\n    }\n\n    @media (max-width: 450px) {\n      .ian-chatbot-window {\n        width: 100vw;\n        height: 100vh;\n        border-radius: 0;\n      }\n\n      .ian-chatbot-widget.bottom-right,\n      .ian-chatbot-widget.bottom-left {\n        bottom: 0;\n        right: 0;\n        left: 0;\n      }\n    }\n  `;let a=!1,o=null;function i(){const t=document.createElement("style");t.textContent=e,document.head.appendChild(t);const a=document.createElement("div");a.className=`ian-chatbot-widget ${n.position}`,a.innerHTML='\n      <div class="ian-chatbot-button" id="ian-chatbot-toggle">\n        <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>\n      </div>\n      <div class="ian-chatbot-window" id="ian-chatbot-window">\n        <div class="ian-chatbot-header">\n          <h3>Asistente Virtual</h3>\n          <button class="ian-chatbot-close" id="ian-chatbot-close">\n            <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\n          </button>\n        </div>\n        <div class="ian-chatbot-messages" id="ian-chatbot-messages">\n          <div class="ian-chatbot-message assistant">\n            <div class="ian-chatbot-message-content">\n              Â¡Hola! ðŸ‘‹ Soy tu asistente virtual. Â¿En quÃ© puedo ayudarte hoy?\n            </div>\n          </div>\n        </div>\n        <div class="ian-chatbot-input-container">\n          <div class="ian-chatbot-input-wrapper">\n            <input \n              type="text" \n              class="ian-chatbot-input" \n              id="ian-chatbot-input" \n              placeholder="Escribe tu mensaje..."\n            />\n            <button class="ian-chatbot-send" id="ian-chatbot-send">\n              Enviar\n            </button>\n          </div>\n        </div>\n      </div>\n    ',document.body.appendChild(a),document.getElementById("ian-chatbot-toggle").addEventListener("click",s),document.getElementById("ian-chatbot-close").addEventListener("click",s),document.getElementById("ian-chatbot-send").addEventListener("click",c),document.getElementById("ian-chatbot-input").addEventListener("keypress",n=>{"Enter"===n.key&&c()})}function s(){a=!a;const n=document.getElementById("ian-chatbot-window"),t=document.getElementById("ian-chatbot-toggle");a?(n.style.display="flex",t.style.display="none",o||d()):(n.style.display="none",t.style.display="flex")}async function d(){try{const t=void 0===window.CHATBOT_DEMO_MODE||window.CHATBOT_DEMO_MODE?"/chat-demo/session":"/chat/session",e=await fetch(`${n.apiUrl}${t}`,{method:"POST",headers:{"Content-Type":"application/json","x-client-token":n.token}});if(e.ok){const n=await e.json();o=n.sessionId}else console.error("Error initializing session")}catch(n){console.error("Error:",n)}}async function c(){const t=document.getElementById("ian-chatbot-input"),e=t.value.trim();if(e&&o){r("user",e),t.value="",function(){const n=document.getElementById("ian-chatbot-messages"),t=document.createElement("div");t.className="ian-chatbot-message assistant",t.id="ian-chatbot-typing",t.innerHTML='\n      <div class="ian-chatbot-typing">\n        <span></span>\n        <span></span>\n        <span></span>\n      </div>\n    ',n.appendChild(t),n.scrollTop=n.scrollHeight}(),t.disabled=!0,document.getElementById("ian-chatbot-send").disabled=!0;try{const t=void 0===window.CHATBOT_DEMO_MODE||window.CHATBOT_DEMO_MODE?"/chat-demo/message":"/chat/message",a=await fetch(`${n.apiUrl}${t}`,{method:"POST",headers:{"Content-Type":"application/json","x-client-token":n.token},body:JSON.stringify({sessionId:o,message:e})});if(a.ok){const n=await a.json();l(),r("assistant",n.message)}else l(),r("assistant","Lo siento, hubo un error. Por favor intenta de nuevo.")}catch(n){console.error("Error:",n),l(),r("assistant","Lo siento, no pude conectarme al servidor.")}finally{t.disabled=!1,document.getElementById("ian-chatbot-send").disabled=!1,t.focus()}}}function r(n,t){const e=document.getElementById("ian-chatbot-messages"),a=document.createElement("div");a.className=`ian-chatbot-message ${n}`,a.innerHTML=`\n      <div class="ian-chatbot-message-content">\n        ${function(n){const t=document.createElement("div");return t.textContent=n,t.innerHTML}(t)}\n      </div>\n    `,e.appendChild(a),e.scrollTop=e.scrollHeight}function l(){const n=document.getElementById("ian-chatbot-typing");n&&n.remove()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}();